<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sales â€” Rabbit Ranch</title>
  <script>(function(){var t=localStorage.getItem("theme");if(t)document.documentElement.setAttribute("data-theme",t);})();</script>
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body data-page="sales">
  <header class="header">
    <div class="brand">
      <h1>Rabbit Ranch</h1>
      <nav class="nav">
        <a href="/dashboard">Dashboard</a>
        <a href="/ranch/animals">Animals</a>
        <a href="/ranch/breedings">Breedings</a>
        <a href="/ranch/kindlings">Kindlings</a>
        <a href="/ranch/weanings">Weanings</a>
        <a href="/ranch/harvests">Harvests</a>
        <a class="active" href="/ranch/sales">Sales</a>
        <a href="/ranch/feed-costs">Feed Costs</a>
        <a href="/ranch/reports">Reports</a>
      </nav>
    </div>
    <div class="header-actions">
      <button id="themeToggle" class="theme-toggle" aria-label="Toggle dark mode" title="Toggle dark mode">ðŸŒ™</button>
      <button id="refreshBtn">Refresh</button>
      <a href="/docs" target="_blank" rel="noopener">API Docs</a>
    </div>
  </header>

  <main class="container">
    <section class="grid" style="grid-template-columns: repeat(3, 1fr); margin-bottom: 12px;">
      <div class="card"><div class="label">Total Sales</div><div class="value" id="s_count">â€”</div></div>
      <div class="card"><div class="label">Total Revenue</div><div class="value" id="s_revenue">â€”</div></div>
      <div class="card"><div class="label">Avg Sale Price</div><div class="value" id="s_avg">â€”</div></div>
    </section>

    <section class="two-col">

      <!-- Left: record sale form -->
      <div style="display: grid; gap: 12px; align-content: start;">
        <div class="card">
          <h2>Record Sale</h2>

          <!-- Toggle between individual and litter -->
          <div class="tabs" id="saleModeToggle" style="margin-bottom: 14px; margin-top: 8px;">
            <button type="button" class="tab active" data-mode="animal">Individual Animal</button>
            <button type="button" class="tab" data-mode="litter">Whole Litter</button>
          </div>

          <form id="saleForm" class="form">
            <!-- Animal selector (shown in animal mode) -->
            <label id="animalSelectWrap" style="grid-column: 1 / -1;">Animal
              <select id="saleAnimalSelect" name="animal_id">
                <option value="">Select animalâ€¦</option>
              </select>
            </label>

            <!-- Litter selector (hidden by default) -->
            <label id="litterSelectWrap" style="grid-column: 1 / -1; display: none;">Litter
              <select id="saleLitterSelect" name="litter_id">
                <option value="">Select litterâ€¦</option>
              </select>
            </label>

            <label>Sale Date<input type="date" name="sale_date" required /></label>
            <label>Sale Price ($)<input type="number" name="sale_price" min="0" step="0.01" required /></label>
            <label>Buyer Name<input name="buyer_name" placeholder="Optional" /></label>
            <label>Buyer Contact<input name="buyer_contact" placeholder="Phone, email, etc." /></label>
            <label style="grid-column: 1 / -1;">Notes<input name="notes" /></label>
            <button type="submit">Record Sale</button>
          </form>

          <div class="hint" id="saleModeHint">
            Selling an individual animal marks it as <code>sold</code>.
          </div>
        </div>

        <div class="card">
          <h2>Summary by Buyer</h2>
          <div class="table-wrap">
            <table id="buyerSummaryTable">
              <thead>
                <tr><th>Buyer</th><th>Sales</th><th>Revenue</th></tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Right: sales table -->
      <div class="card">
        <div class="card-title">
          <h2>Sales</h2>
          <div class="actions-row">
            <input id="saleFilter" class="filter" placeholder="Filter (buyer/date/animal)â€¦" />
          </div>
        </div>
        <div class="hint" id="saleCount">â€”</div>
        <div class="table-wrap">
          <table id="salesTable">
            <thead>
              <tr>
                <th>ID</th>
                <th>Date</th>
                <th>Subject</th>
                <th>Price</th>
                <th>Buyer</th>
                <th>Contact</th>
                <th>Notes</th>
                <th></th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

    </section>
  </main>

  <div id="toast" class="toast" hidden></div>
  <script src="/static/app.js"></script>
</body>
</html>
